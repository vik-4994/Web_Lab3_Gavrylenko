<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>Crypto Monitor</title>
  <script>
    let socket;

    function login() {
      window.location.href = "/login";
    }

    function connectWS() {
      socket = new WebSocket("ws://localhost:8444/ws/price");

      socket.onmessage = function (event) {
        const data = JSON.parse(event.data);
        document.getElementById("price").innerText = "üí≤ " + data.p;
      };
    }

    function selectCoin() {
      const symbol = document.getElementById("coin").value;
      socket.send(JSON.stringify({symbol}));
    }

    window.onload = function () {
      connectWS();
    };
  </script>
</head>
<body>
<h1>üåç Crypto Dashboard</h1>

<div>
  <button onclick="login()">üîê Login via Casdoor</button>
</div>

<div>
  <label>–ú–æ–Ω–µ—Ç–∞:
    <select id="coin" onchange="selectCoin()">
      <option value="btcusdt">BTC/USDT</option>
      <option value="ethusdt">ETH/USDT</option>
      <option value="bnbusdt">BNB/USDT</option>
    </select>
  </label>
</div>

<div>
  <p id="price">üìâ –ß–µ–∫–∞—î–º–æ –¥–∞–Ω—ñ...</p>
</div>
</body>
</html>
